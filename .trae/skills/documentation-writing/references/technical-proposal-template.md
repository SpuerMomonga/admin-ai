# 技术方案文档结构（Design Doc）

目标：用于方案评审与后续落地对齐；读者无需额外会议即可理解“做什么/为什么/怎么做/怎么回滚”。

---

# {{标题}}

## 1. 背景与问题陈述

- 现状是什么
- 痛点/风险/机会是什么
- 业务影响（量化优先）：成本、稳定性、性能、交付效率

## 2. 目标（Goals）

- 必须达成的目标
- 成功指标（可度量）

## 3. 非目标（Non-Goals）

- 明确不做的内容，避免范围蔓延

## 4. 约束与假设

- 时间/资源/兼容性/合规
- 依赖项与前置条件

## 5. 方案概述

- 高层架构图（可选）
- 核心流程（输入 → 处理 → 输出）
- 数据流与状态变化

## 6. 详细设计

### 6.1 接口与契约

- API/事件/消息格式
- DTO 与字段语义
- 错误语义与状态码/错误码

### 6.2 数据模型与迁移（如适用）

- 表结构/索引/约束
- 迁移步骤与回滚策略

### 6.3 可靠性与一致性

- 幂等、重试、超时
- 并发控制（锁/唯一约束/乐观锁）
- 失败模式与降级

### 6.4 性能与容量

- 关键路径性能目标
- 预估 QPS/数据量
- 缓存/批处理策略

### 6.5 安全与权限

- 鉴权/授权策略
- 数据脱敏与最小权限
- 审计与合规（如适用）

## 7. 备选方案（Alternatives）

- 至少 1 个备选方案
- 为什么不选（成本、风险、复杂度、演进性）

## 8. 测试计划

- 单元/集成/端到端覆盖范围
- 回归用例列表（关键链路）
- 可观测性验证（日志/指标/追踪）

## 9. 发布与回滚计划

- 分阶段发布（灰度/开关/双写）
- 迁移顺序与依赖
- 回滚条件与回滚步骤

## 10. 风险清单与缓解措施

| 风险 | 影响 | 可能性 | 缓解措施 | 监控/告警 |
| ---- | ---- | ------ | -------- | --------- |
| ...  | ...  | ...    | ...      | ...       |

---

## 方案完整性检查清单

- 目标可度量，非目标清晰
- 契约（API/事件/错误语义）明确且可演进
- 可靠性与回滚方案可执行
- 测试计划覆盖关键链路与失败模式
