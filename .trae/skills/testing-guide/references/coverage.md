# 测试覆盖率要求

## 原则

- 覆盖率是下限指标，不是质量上限
- 优先覆盖“风险最高”的代码：资金/权限/计费/数据写入/外部交互/错误处理
- 目标是可预期回归防护，而不是追求数字漂亮

## 建议门槛（可按模块调整）

- 关键业务模块：
  - 语句/行覆盖率：≥ 80%
  - 分支覆盖率：≥ 70%
- 低风险或纯适配层：
  - 语句/行覆盖率：≥ 60%
  - 分支覆盖率：≥ 50%

## 强制要求

- 新增/修复的逻辑必须新增或更新测试，覆盖对应行为点
- 对外接口的错误语义（错误码/状态码/消息）必须覆盖
- 幂等、重试、超时、降级等关键可靠性逻辑必须覆盖

## 允许的例外（需说明理由）

- 临时代码路径（明确有删除计划且可追踪）
- 第三方库封装的薄适配层（但需集成用例覆盖关键契约）
- 难以稳定复现的竞态路径（需通过更可测设计或集成/压力测试补充）

## 提升覆盖率的优先顺序

1. 补齐关键链路的行为测试（优先单元/集成）
2. 覆盖错误分支与边界条件
3. 覆盖不可达/难测逻辑前先重构（依赖注入、拆分纯函数）

